{% extends "dashboards/base_dashboard.html" %}
{% block dashboard_content %}

<div class="max-w-4xl mx-auto">

  <div class="mb-8 flex items-center gap-3 animate-fade-up">
    <div class="h-12 w-12 bg-blue-100 rounded-2xl flex items-center justify-center text-2xl shadow-sm text-blue-600">ðŸš›
    </div>
    <div>
      <h2 class="text-3xl font-heading font-bold text-gray-800">Assigned Jobs</h2>
      <p class="text-gray-500">Your active pickup tasks.</p>
    </div>
  </div>

  {% if reports %}
  <div class="space-y-6">
    {% for report in reports %}
    <div
      class="glass-card rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 animate-fade-up group border border-white/40">

      <div class="flex flex-col sm:flex-row gap-6">

        <!-- Image -->
        <div class="w-full sm:w-1/3 h-48 sm:h-auto rounded-xl overflow-hidden relative shadow-md">
          <img src="{{ report.image.url }}"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
          <div class="absolute bottom-2 left-2">
            <span class="px-2 py-1 bg-black/50 backdrop-blur rounded text-white text-xs font-bold shadow-sm">
              {{ report.get_waste_type_display }}
            </span>
          </div>
        </div>

        <!-- Content -->
        <div class="flex-1 flex flex-col">
          <div class="flex justify-between items-start">
            <div>
              <h3 class="text-xl font-bold text-gray-800 mb-1">Waste Pickup #{{ report.id }}</h3>
              <p class="text-sm text-gray-500 flex items-center gap-1">
                ðŸ•’ Assigned: {{ report.created_at|date:"M d â€¢ h:i A" }}
              </p>
            </div>

            <span class="px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider
               {% if report.severity == 'high' %} bg-red-100 text-red-600
               {% elif report.severity == 'medium' %} bg-yellow-100 text-yellow-600
               {% else %} bg-green-100 text-green-600 {% endif %}">
              {{ report.severity }} Priority
            </span>
          </div>

          <div class="my-4 bg-gray-50/80 p-3 rounded-lg border border-gray-100/50">
            <p class="text-gray-700 text-sm">"{{ report.description }}"</p>
          </div>

          <!-- Actions -->
          <div class="mt-auto pt-2">
            <form method="post" action="{% url 'resolve_report' report.id %}">
              {% csrf_token %}
              <button type="submit"
                class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 rounded-xl shadow-lg hover:shadow-green-500/30 hover:-translate-y-0.5 transition-all flex justify-center items-center gap-2">
                <span class="text-lg">âœ…</span> Mark as Resolved
              </button>
            </form>
          </div>
        </div>

      </div>

    </div>
    {% endfor %}
  </div>

  {% else %}
  <div
    class="text-center py-20 bg-white/50 backdrop-blur rounded-3xl border border-dashed border-gray-300 animate-scale-in">
    <div class="text-6xl mb-4 grayscale opacity-30">ðŸšš</div>
    <h3 class="text-xl font-bold text-gray-600">No active jobs</h3>
    <p class="text-gray-400 mt-2">You're all clear! Relax until new tasks arrive.</p>
  </div>
  {% endif %}

</div>
{% endblock %}