{% extends "dashboards/base_dashboard.html" %}
{% block title %}My Reports{% endblock %}

{% block dashboard_content %}
<div>

  <!-- Header -->
  <div class="flex justify-between items-end mb-8">
    <div>
      <h1 class="text-4xl font-heading font-bold text-gray-800 dark:text-gray-100 mb-2">My Reports</h1>
      <p class="text-gray-500 dark:text-gray-400">Track and manage your submitted waste reports.</p>
    </div>
    <a href="{% url 'report_waste' %}"
      class="relative z-10 bg-gradient-to-r from-eco-500 to-teal-500 text-white px-6 py-3 rounded-xl shadow-lg shadow-eco-500/30 hover:shadow-eco-500/50 hover:-translate-y-1 transition-all duration-300 font-bold flex items-center gap-2">
      <span class="text-xl">+</span> New Report
    </a>
  </div>


  {% if reports %}
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-6">

    {% for report in reports %}
    <div
      class="glass-card rounded-2xl overflow-hidden group hover:shadow-2xl hover:shadow-eco-500/10 transition-all duration-300 relative flex flex-col h-full">

      <!-- Status Badge -->
      <div class="absolute top-4 right-4 z-10">
        <span class="px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider backdrop-blur-md shadow-sm border border-white/20
          {% if report.status == 'pending' %} bg-yellow-100/90 dark:bg-yellow-900/40 text-yellow-700 dark:text-yellow-400
          {% elif report.status == 'assigned' %} bg-blue-100/90 dark:bg-blue-900/40 text-blue-700 dark:text-blue-400
          {% else %} bg-eco-100/90 dark:bg-eco-900/40 text-eco-700 dark:text-eco-400 {% endif %}">
          {{ report.status }}
        </span>
      </div>

      <!-- Image -->
      <a href="{% url 'report_detail' report.id %}" class="block overflow-hidden h-56 relative">
        <div
          class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60 group-hover:opacity-40 transition-opacity">
        </div>
        <img src="{{ report.image.url }}"
          class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">

        <!-- Severity Indicator overlay -->
        <div class="absolute bottom-4 left-4 text-white">
          <span class="text-xs font-medium bg-black/40 px-2 py-1 rounded backdrop-blur-sm">
            {{ report.get_severity_display }} Severity
          </span>
        </div>
      </a>

      <!-- Content -->
      <div class="p-6 flex-1 flex flex-col">
        <div class="mb-4">
          <h3
            class="text-xl font-bold text-gray-800 dark:text-gray-100 group-hover:text-eco-600 dark:group-hover:text-eco-400 transition-colors mb-1">
            {{ report.get_waste_type_display }}
          </h3>
          <p class="text-sm text-gray-400 dark:text-gray-500">
            {{ report.created_at|date:"M d, Y â€¢ h:i A" }}
          </p>
        </div>

        <p class="text-gray-600 dark:text-gray-400 text-sm line-clamp-2 mb-6 flex-grow">
          {{ report.description }}
        </p>

        <!-- Actions -->
        <div class="flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700 mt-auto">
          <a href="{% url 'report_detail' report.id %}"
            class="text-eco-600 dark:text-eco-400 font-bold text-sm hover:underline">
            View Details
          </a>

          <div class="flex items-center gap-3">
            {% if report.status == "assigned" %}
            <a href="{% url 'track_worker' report.id %}"
              class="flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg text-xs font-bold hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-all">
              ğŸ“ Track
            </a>
            {% endif %}

            {% if report.status == "pending" %}
            <a href="{% url 'edit_report' report.id %}" class="text-gray-400 hover:text-blue-500 transition"
              title="Edit">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
              </svg>
            </a>
            <a href="{% url 'delete_report' report.id %}" class="text-gray-400 hover:text-red-500 transition"
              title="Delete">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </a>
            {% endif %}
          </div>
        </div>

      </div>
    </div>
    {% endfor %}

  </div>

  {% else %}
  <div
    class="text-center py-20 bg-white dark:bg-gray-800 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700">
    <div class="text-6xl mb-6">ğŸƒ</div>
    <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2">No Reports Yet</h3>
    <p class="text-gray-500 dark:text-gray-400 mb-8 max-w-md mx-auto">You haven't submitted any waste reports yet. Be
      the first to make a
      difference in your community!</p>
    <a href="{% url 'report_waste' %}"
      class="inline-block bg-eco-600 text-white px-8 py-3 rounded-full font-bold shadow-lg shadow-eco-500/30 hover:shadow-eco-500/50 hover:-translate-y-1 transition transform">
      Start Reporting
    </a>
  </div>
  {% endif %}

</div>
{% endblock %}