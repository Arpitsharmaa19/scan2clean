{% extends "dashboards/base_dashboard.html" %}

{% block dashboard_content %}

<!-- ğŸŒˆ Admin Header -->
<div class="relative rounded-3xl p-10 text-white mb-10 overflow-hidden shadow-2xl animate-fade-up group">
  <!-- Dynamic Background -->
  <div
    class="absolute inset-0 bg-gradient-to-r from-gray-800 to-slate-900 transition-transform duration-1000 group-hover:scale-105">
  </div>
  <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-30">
  </div>
  <div
    class="absolute -right-10 -bottom-10 text-9xl opacity-10 transform rotate-12 group-hover:rotate-6 transition-transform duration-700">
    âš™ï¸</div>

  <div class="relative z-10">
    <h1 class="text-4xl font-heading font-bold mb-2 text-white drop-shadow-sm flex items-center gap-3">
      Admin Control Center
    </h1>
    <p class="text-gray-300 text-lg font-medium opacity-90">
      System Overview â€¢ <span class="text-green-400 font-bold">â— Operational</span>
    </p>
  </div>
</div>

<!-- ğŸ“Š System Stats -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">

  <!-- Users -->
  <div
    class="glass-card rounded-2xl p-6 shadow-lg hover:-translate-y-1 transition-transform border-l-4 border-indigo-500 animate-fade-up delay-100">
    <div class="flex justify-between items-start">
      <div>
        <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Total Users</p>
        <p class="text-3xl font-heading font-bold text-gray-800">{{ total_users|default:"0" }}</p>
      </div>
      <div class="h-10 w-10 bg-indigo-100 rounded-full flex items-center justify-center text-xl">ğŸ‘¥</div>
    </div>
  </div>

  <!-- Reports -->
  <div
    class="glass-card rounded-2xl p-6 shadow-lg hover:-translate-y-1 transition-transform border-l-4 border-orange-500 animate-fade-up delay-200">
    <div class="flex justify-between items-start">
      <div>
        <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Total Reports</p>
        <p class="text-3xl font-heading font-bold text-gray-800">{{ total_reports|default:"0" }}</p>
      </div>
      <div class="h-10 w-10 bg-orange-100 rounded-full flex items-center justify-center text-xl">ğŸ“</div>
    </div>
  </div>

  <!-- Pending -->
  <div
    class="glass-card rounded-2xl p-6 shadow-lg hover:-translate-y-1 transition-transform border-l-4 border-yellow-400 animate-fade-up delay-300">
    <div class="flex justify-between items-start">
      <div>
        <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Pending</p>
        <p class="text-3xl font-heading font-bold text-gray-800">{{ pending_reports|default:"0" }}</p>
      </div>
      <div class="h-10 w-10 bg-yellow-100 rounded-full flex items-center justify-center text-xl">â³</div>
    </div>
  </div>

  <!-- Resolved -->
  <div
    class="glass-card rounded-2xl p-6 shadow-lg hover:-translate-y-1 transition-transform border-l-4 border-green-500 animate-fade-up delay-400">
    <div class="flex justify-between items-start">
      <div>
        <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Resolved</p>
        <p class="text-3xl font-heading font-bold text-gray-800">{{ resolved_reports|default:"0" }}</p>
      </div>
      <div class="h-10 w-10 bg-green-100 rounded-full flex items-center justify-center text-xl">âœ…</div>
    </div>
  </div>

</div>

<!-- ğŸ“ˆ Data Visualization -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">

  <!-- Status Chart -->
  <div class="glass-card rounded-2xl p-6 shadow-lg animate-fade-up delay-500">
    <h3 class="text-lg font-bold text-gray-700 mb-6 flex items-center gap-2">
      <span class="p-2 bg-purple-100 text-purple-600 rounded-lg">ğŸ“Š</span> Report Status Distribution
    </h3>
    <div class="relative h-64">
      <canvas id="adminStatusChart"></canvas>
    </div>
  </div>

  <!-- Waste Type Chart -->
  <div class="glass-card rounded-2xl p-6 shadow-lg animate-fade-up delay-500">
    <h3 class="text-lg font-bold text-gray-700 mb-6 flex items-center gap-2">
      <span class="p-2 bg-teal-100 text-teal-600 rounded-lg">ğŸ—‘ï¸</span> Waste Composition
    </h3>
    <div class="relative h-64 flex justify-center">
      <canvas id="adminWasteChart"></canvas>
    </div>
  </div>

</div>

<!-- ğŸ§­ Admin Actions -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 animate-fade-up delay-600">

  <a href="{% url 'admin_all_reports' %}"
    class="glass-card p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group ring-1 ring-black/5 bg-gradient-to-br from-white to-gray-50">
    <div
      class="h-12 w-12 bg-blue-100 rounded-xl flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition-transform">
      ğŸ“</div>
    <h3 class="text-lg font-bold text-gray-800 mb-1">Manage Reports</h3>
    <p class="text-gray-500 text-sm">Assign reports to workers and track resolution.</p>
  </a>

  <a href="{% url 'worker_performance_dashboard' %}"
    class="glass-card p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group ring-1 ring-black/5 bg-gradient-to-br from-white to-gray-50">
    <div
      class="h-12 w-12 bg-indigo-100 rounded-xl flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition-transform">
      ğŸ‘·</div>
    <h3 class="text-lg font-bold text-gray-800 mb-1">Worker Management</h3>
    <p class="text-gray-500 text-sm">Monitor performance metrics and efficiency.</p>
  </a>

  <div
    class="glass-card p-6 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group ring-1 ring-black/5 bg-gradient-to-br from-white to-gray-50 cursor-pointer opacity-75 hover:opacity-100">
    <div
      class="h-12 w-12 bg-gray-100 rounded-xl flex items-center justify-center text-2xl mb-4 group-hover:scale-110 transition-transform">
      âš™ï¸</div>
    <h3 class="text-lg font-bold text-gray-800 mb-1">System Settings</h3>
    <p class="text-gray-500 text-sm">Configure user roles and system parameters.</p>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Status Chart
    const pendingVal = Number("{{ pending_reports|default:'0' }}");
    const assignedVal = Number("{{ assigned_reports|default:'0' }}");
    const resolvedVal = Number("{{ resolved_reports|default:'0' }}");

    const statusCtx = document.getElementById('adminStatusChart');
    if (statusCtx) {
      new Chart(statusCtx, {
        type: 'bar',
        data: {
          labels: ['Pending', 'Assigned', 'Resolved'],
          datasets: [{
            label: 'Count',
            data: [pendingVal, assignedVal, resolvedVal],
            backgroundColor: ['#facc15', '#60a5fa', '#22c55e'],
            borderRadius: 6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
            x: { grid: { display: false } }
          }
        }
      });
    }

    // Waste Composition Chart
    const wasteLabels = JSON.parse('{{ waste_labels|safe|default:"[]" }}');
    const wasteValues = JSON.parse('{{ waste_values|safe|default:"[]" }}');

    const wasteCtx = document.getElementById('adminWasteChart');
    if (wasteCtx) {
      new Chart(wasteCtx, {
        type: 'doughnut',
        data: {
          labels: wasteLabels,
          datasets: [{
            data: wasteValues,
            backgroundColor: ['#f97316', '#22c55e', '#3b82f6', '#a855f7', '#ef4444'],
            borderWidth: 0,
            hoverOffset: 10
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          cutout: '65%',
          plugins: {
            legend: { position: 'right', labels: { usePointStyle: true, font: { family: 'Inter', size: 11 } } }
          }
        }
      });
    }
  });
</script>

{% endblock %}